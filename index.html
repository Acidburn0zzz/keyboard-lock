<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>System Keyboard Lock </title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="WD" name="w3c-status">
  <link href="../default.css" rel="stylesheet" type="text/css">
  <link href="../csslogo.ico" rel="shortcut icon" type="image/x-icon">
  <link href="styles.css" rel="stylesheet" type="text/css">
  <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-WD" rel="stylesheet" type="text/css">
  <meta content="Bikeshed 1.0.0" name="generator">
<style>/* style-md-lists */

            /* This is a weird hack for me not yet following the commonmark spec
               regarding paragraph and lists. */
            [data-md] > :first-child {
                margin-top: 0;
            }
            [data-md] > :last-child {
                margin-bottom: 0;
            }</style>
<style>/* style-selflinks */

            .heading, .issue, .note, .example, li, dt {
                position: relative;
            }
            a.self-link {
                position: absolute;
                top: 0;
                left: calc(-1 * (3.5rem - 26px));
                width: calc(3.5rem - 26px);
                height: 2em;
                text-align: center;
                border: none;
                transition: opacity .2s;
                opacity: .5;
            }
            a.self-link:hover {
                opacity: 1;
            }
            .heading > a.self-link {
                font-size: 83%;
            }
            li > a.self-link {
                left: calc(-1 * (3.5rem - 26px) - 2em);
            }
            dfn > a.self-link {
                top: auto;
                left: auto;
                opacity: 0;
                width: 1.5em;
                height: 1.5em;
                background: gray;
                color: white;
                font-style: normal;
                transition: opacity .2s, background-color .2s, color .2s;
            }
            dfn:hover > a.self-link {
                opacity: 1;
            }
            dfn > a.self-link:hover {
                color: black;
            }

            a.self-link::before            { content: "¶"; }
            .heading > a.self-link::before { content: "§"; }
            dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

            body {
                counter-reset: example figure issue;
            }
            .issue {
                counter-increment: issue;
            }
            .issue:not(.no-marker)::before {
                content: "Issue " counter(issue);
            }

            .example {
                counter-increment: example;
            }
            .example:not(.no-marker)::before {
                content: "Example " counter(example);
            }
            .invalid.example:not(.no-marker)::before,
            .illegal.example:not(.no-marker)::before {
                content: "Invalid Example" counter(example);
            }

            figcaption {
                counter-increment: figure;
            }
            figcaption:not(.no-marker)::before {
                content: "Figure " counter(figure) " ";
            }</style>
<style>/* style-autolinks */

            .css.css, .property.property, .descriptor.descriptor {
                color: #005a9c;
                font-size: inherit;
                font-family: inherit;
            }
            .css::before, .property::before, .descriptor::before {
                content: "‘";
            }
            .css::after, .property::after, .descriptor::after {
                content: "’";
            }
            .property, .descriptor {
                /* Don't wrap property and descriptor names */
                white-space: nowrap;
            }
            .type { /* CSS value <type> */
                font-style: italic;
            }
            pre .property::before, pre .property::after {
                content: "";
            }
            [data-link-type="property"]::before,
            [data-link-type="propdesc"]::before,
            [data-link-type="descriptor"]::before,
            [data-link-type="value"]::before,
            [data-link-type="function"]::before,
            [data-link-type="at-rule"]::before,
            [data-link-type="selector"]::before,
            [data-link-type="maybe"]::before {
                content: "‘";
            }
            [data-link-type="property"]::after,
            [data-link-type="propdesc"]::after,
            [data-link-type="descriptor"]::after,
            [data-link-type="value"]::after,
            [data-link-type="function"]::after,
            [data-link-type="at-rule"]::after,
            [data-link-type="selector"]::after,
            [data-link-type="maybe"]::after {
                content: "’";
            }

            [data-link-type].production::before,
            [data-link-type].production::after,
            .prod [data-link-type]::before,
            .prod [data-link-type]::after {
                content: "";
            }

            [data-link-type=element],
            [data-link-type=element-attr] {
                font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
                font-size: .9em;
            }
            [data-link-type=element]::before { content: "<" }
            [data-link-type=element]::after  { content: ">" }

            [data-link-type=biblio] {
                white-space: pre;
            }</style>
<style>/* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel ul { padding: 0; }
        .dfn-panel li { list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
        .highlight:not(.idl) { background: hsl(24, 20%, 95%); }
        code.highlight { padding: .1em; border-radius: .3em; }
        pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
        .highlight .c { color: #708090 } /* Comment */
        .highlight .k { color: #990055 } /* Keyword */
        .highlight .l { color: #000000 } /* Literal */
        .highlight .n { color: #0077aa } /* Name */
        .highlight .o { color: #999999 } /* Operator */
        .highlight .p { color: #999999 } /* Punctuation */
        .highlight .cm { color: #708090 } /* Comment.Multiline */
        .highlight .cp { color: #708090 } /* Comment.Preproc */
        .highlight .c1 { color: #708090 } /* Comment.Single */
        .highlight .cs { color: #708090 } /* Comment.Special */
        .highlight .kc { color: #990055 } /* Keyword.Constant */
        .highlight .kd { color: #990055 } /* Keyword.Declaration */
        .highlight .kn { color: #990055 } /* Keyword.Namespace */
        .highlight .kp { color: #990055 } /* Keyword.Pseudo */
        .highlight .kr { color: #990055 } /* Keyword.Reserved */
        .highlight .kt { color: #990055 } /* Keyword.Type */
        .highlight .ld { color: #000000 } /* Literal.Date */
        .highlight .m { color: #000000 } /* Literal.Number */
        .highlight .s { color: #a67f59 } /* Literal.String */
        .highlight .na { color: #0077aa } /* Name.Attribute */
        .highlight .nc { color: #0077aa } /* Name.Class */
        .highlight .no { color: #0077aa } /* Name.Constant */
        .highlight .nd { color: #0077aa } /* Name.Decorator */
        .highlight .ni { color: #0077aa } /* Name.Entity */
        .highlight .ne { color: #0077aa } /* Name.Exception */
        .highlight .nf { color: #0077aa } /* Name.Function */
        .highlight .nl { color: #0077aa } /* Name.Label */
        .highlight .nn { color: #0077aa } /* Name.Namespace */
        .highlight .py { color: #0077aa } /* Name.Property */
        .highlight .nt { color: #669900 } /* Name.Tag */
        .highlight .nv { color: #222222 } /* Name.Variable */
        .highlight .ow { color: #999999 } /* Operator.Word */
        .highlight .mb { color: #000000 } /* Literal.Number.Bin */
        .highlight .mf { color: #000000 } /* Literal.Number.Float */
        .highlight .mh { color: #000000 } /* Literal.Number.Hex */
        .highlight .mi { color: #000000 } /* Literal.Number.Integer */
        .highlight .mo { color: #000000 } /* Literal.Number.Oct */
        .highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
        .highlight .sc { color: #a67f59 } /* Literal.String.Char */
        .highlight .sd { color: #a67f59 } /* Literal.String.Doc */
        .highlight .s2 { color: #a67f59 } /* Literal.String.Double */
        .highlight .se { color: #a67f59 } /* Literal.String.Escape */
        .highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
        .highlight .si { color: #a67f59 } /* Literal.String.Interpol */
        .highlight .sx { color: #a67f59 } /* Literal.String.Other */
        .highlight .sr { color: #a67f59 } /* Literal.String.Regex */
        .highlight .s1 { color: #a67f59 } /* Literal.String.Single */
        .highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
        .highlight .vc { color: #0077aa } /* Name.Variable.Class */
        .highlight .vg { color: #0077aa } /* Name.Variable.Global */
        .highlight .vi { color: #0077aa } /* Name.Variable.Instance */
        .highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
        </style>
 <body class="h-entry">
  <div class="head">
   <header>
    <p data-fill-with="logo"><a href="http://www.w3.org/"><img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"></a></p>
    <h1>System Keyboard Lock</h1>
    <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">W3C Working Draft, <time class="dt-updated" datetime="2016-11-11">11 November 2016</time></span></h2>
   </header>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://www.w3.org/TR/2016/WD-systemkeylock-20161111/">https://www.w3.org/TR/2016/WD-systemkeylock-20161111/</a>
     <dt>Latest published version:
     <dd><a href="http://www.w3.org/TR/systemkeylock/">http://www.w3.org/TR/systemkeylock/</a>
     <dt>Editor's Draft:
     <dd><a href="https://github.com/w3c/systemkeylock/">https://github.com/w3c/systemkeylock/</a>
     <dt>Previous Versions:
     <dd><a href="" rel="previous"></a>
     <dd><a href="<none>" rel="previous">&lt;none></a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/garykac/system-keyboard-lock/issues/">GitHub</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><span class="p-name fn"></span>
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:garykac@google.com">Gary Kacmarcik</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:jamiewalch@google.com">Jamie Walch</a> (<span class="p-org org">Google</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2016 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This specification defines an API that allows websites to

capture keys that are normally reserved by the underlying host
operating system. It is intended to be used by web
applications that provide a fullscreen immersive experience
(like games or remote access apps).</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of its publication. Other
    documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this
    technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical
    reports index</a> at http://www.w3.org/TR/.</em> </p>
   <p> The management and production of this document follows a relatively complex setup. Details are
    provided as part of the introduction. </p>
   <p> This document was published by the <a href="https://www.w3.org/WebPlatform/WG/">Web Platform Working Group</a> as a Working Draft.

    Feedback and comments on this specification are welcome. Please use <a href="https://github.com/w3c/systemkeylock/issues">Github issues</a> Historical discussions can be found in the <a href="http://lists.w3.org/Archives/Public/public-webapps/">public-webapps@w3.org archives</a>. </p>
   <p> Publication as a Working Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership. This is a draft document and may
    be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite
    this document as other than work in progress. </p>
   <p> This document was produced by a group operating under the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="http://www.w3.org/2004/01/pp-impl/40318/status" rel="disclosure">public list of any
    patent disclosures</a> made in connection with the deliverables of the group; that page also
    includes instructions for disclosing a patent. An individual who has actual knowledge of a
    patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
    Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. </p>
   <p> This document is governed by the <a href="http://www.w3.org/2015/Process-20150901/" id="w3c_process_revision">1 September 2015 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#API"><span class="secno">2</span> <span class="content">Activating and Deactivating System Keyboard Lock</span></a>
    <li><a href="#handling-focus-events"><span class="secno">3</span> <span class="content">Handling Focus Events</span></a>
    <li><a href="#handling-key-presses"><span class="secno">4</span> <span class="content">Handling Key Presses</span></a>
    <li><a href="#mobile"><span class="secno">5</span> <span class="content">Mobile Device Considerations</span></a>
    <li><a href="#security"><span class="secno">6</span> <span class="content">Security Considerations</span></a>
    <li><a href="#privacy"><span class="secno">7</span> <span class="content">Privacy Considerations</span></a>
    <li><a href="#acknowledgements-contributors"><span class="secno">8</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <p>Richly interactive web sites, games and remote
	desktop/application streaming experiences want to provide an
	immersive, full screen experience. To accomplish this, sites
	need access to special keys and keyboard shortcuts while they
	are in full screen mode so that they can be used for
	navigation, menus or gaming functionality. Some examples of
	the keys that may be required are Escape, Alt+Tab, Cmd+`, and
	Ctrl+N.</p>
   <p>By default, these keys are not available to the web application because
	they are captured by the browser or the underlying operating
	system. The System Keyboard Lock API enables websites to capture and use
	all available keys allowed by the OS.</p>
   <h2 class="heading settled" data-level="2" id="API"><span class="secno">2. </span><span class="content">Activating and Deactivating System Keyboard Lock</span><a class="self-link" href="#API"></a></h2>
<pre class="idl highlight def" data-highlight="webidl"><span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a> {
  [Secure Context] <span class="kt">void</span> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Navigator" data-dfn-type="method" data-export="" data-lt="requestSystemKeyboardLock(keyCodes)|requestSystemKeyboardLock()" id="dom-navigator-requestsystemkeyboardlock">requestSystemKeyboardLock</dfn>(<span class="kt">optional</span> <span class="kt">sequence</span>&lt;<span class="kt">DOMString</span>> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Navigator/requestSystemKeyboardLock(keyCodes), Navigator/requestSystemKeyboardLock()" data-dfn-type="argument" data-export="" id="dom-navigator-requestsystemkeyboardlock-keycodes-keycodes">keyCodes</dfn>);
  [Secure Context] <span class="kt">void</span> <dfn class="nv dfn-paneled idl-code" data-dfn-for="Navigator" data-dfn-type="method" data-export="" data-lt="cancelSystemKeyboardLock()" id="dom-navigator-cancelsystemkeyboardlock">cancelSystemKeyboardLock</dfn>();
};
</pre>
   <p>If <code class="idl"><a data-link-type="idl" href="#dom-navigator-requestsystemkeyboardlock-keycodes-keycodes" id="ref-for-dom-navigator-requestsystemkeyboardlock-keycodes-keycodes-1">keyCodes</a></code> is not present, it should be considered to contain all the
	values specified in <a data-link-type="biblio" href="#biblio-uievents-code">[UIEvents-Code]</a> throughout this specification.</p>
   <p>In response to <code class="idl"><a data-link-type="idl" href="#dom-navigator-requestsystemkeyboardlock" id="ref-for-dom-navigator-requestsystemkeyboardlock-1">requestSystemKeyboardLock()</a></code>, the user agent should
 	run the following steps:</p>
   <ol>
    <li data-md="">
     <p>If full-screen mode is not active, do nothing.</p>
    <li data-md="">
     <p>If <code class="idl"><a data-link-type="idl" href="#dom-navigator-requestsystemkeyboardlock-keycodes-keycodes" id="ref-for-dom-navigator-requestsystemkeyboardlock-keycodes-keycodes-2">keyCodes</a></code> is present, delete duplicate elements and any element
that does not correspond to one of the values specified in <a data-link-type="biblio" href="#biblio-uievents-code">[UIEvents-Code]</a>.</p>
    <li data-md="">
     <p>Save <code class="idl"><a data-link-type="idl" href="#dom-navigator-requestsystemkeyboardlock-keycodes-keycodes" id="ref-for-dom-navigator-requestsystemkeyboardlock-keycodes-keycodes-3">keyCodes</a></code> as <dfn class="dfn-paneled idl-code" data-dfn-for="navigator" data-dfn-type="attribute" data-export="" id="dom-navigator-reservedkeycodes">reservedKeyCodes</dfn> for future reference.</p>
    <li data-md="">
     <p>If system keyboard lock is not already active, and if the user agent has
input focus, register a keyboard handler that runs before any user-agent
keyboard shortcuts are processed. If the operating system supports it,
this should also run before any system keyboard shortcuts are processed.
See <a data-link-type="biblio" href="#biblio-lowlevelkeyboardproc">[LowLevelKeyboardProc]</a>, <a data-link-type="biblio" href="#biblio-quartzeventservices">[QuartzEventServices]</a> and <a data-link-type="biblio" href="#biblio-grabkeyboard">[GrabKeyboard]</a> for examples for the Windows, Mac and OS X platforms,
respectively.</p>
   </ol>
   <p>In response to <code class="idl"><a data-link-type="idl" href="#dom-navigator-cancelsystemkeyboardlock" id="ref-for-dom-navigator-cancelsystemkeyboardlock-1">cancelSystemKeyboardLock()</a></code>, or if full-screen is exited
    while system keyboard lock is active, the user agent should run the
    following steps:</p>
   <ol>
    <li data-md="">
     <p>If keyboard lock is in effect:</p>
     <ol>
      <li data-md="">
       <p>Clear the <code class="idl"><a data-link-type="idl" href="#dom-navigator-reservedkeycodes" id="ref-for-dom-navigator-reservedkeycodes-1">reservedKeyCodes</a></code> value saved from the previous call to <code class="idl"><a data-link-type="idl" href="#dom-navigator-requestsystemkeyboardlock" id="ref-for-dom-navigator-requestsystemkeyboardlock-2">requestSystemKeyboardLock()</a></code>.</p>
      <li data-md="">
       <p>Unregister the low-level keyboard handler that was registered
previously.</p>
     </ol>
   </ol>
   <h2 class="heading settled" data-level="3" id="handling-focus-events"><span class="secno">3. </span><span class="content">Handling Focus Events</span><a class="self-link" href="#handling-focus-events"></a></h2>
   <p>If system keyboard lock is active when the user agent loses keyboard focus,
    it must ensure that system keys are processed as if system keyboard lock was
    not active.</p>
   <p>When the user agent regains keyboard focus, if <code class="idl"><a data-link-type="idl" href="#dom-navigator-reservedkeycodes" id="ref-for-dom-navigator-reservedkeycodes-2">reservedKeyCodes</a></code> is set
    and full-screen is active, it should reactivate system keyboard lock with <code class="idl"><a data-link-type="idl" href="#dom-navigator-reservedkeycodes" id="ref-for-dom-navigator-reservedkeycodes-3">reservedKeyCodes</a></code> as the <code class="idl"><a data-link-type="idl" href="#dom-navigator-requestsystemkeyboardlock-keycodes-keycodes" id="ref-for-dom-navigator-requestsystemkeyboardlock-keycodes-keycodes-4">keyCodes</a></code> parameter.</p>
   <h2 class="heading settled" data-level="4" id="handling-key-presses"><span class="secno">4. </span><span class="content">Handling Key Presses</span><a class="self-link" href="#handling-key-presses"></a></h2>
   <p>In response to the user pressing a key, if a low-level keyboard handler
	is registered, it should run the following steps:</p>
   <ol>
    <li data-md="">
     <p>Let <dfn class="dfn-paneled idl-code" data-dfn-for="navigator" data-dfn-type="attribute" data-export="" id="dom-navigator-keyevent">keyEvent</dfn> be the key event for the
new key press.</p>
    <li data-md="">
     <p>Compare the <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/uievents/#dom-keyboardevent-code">code</a></code> attribute of <code class="idl"><a data-link-type="idl" href="#dom-navigator-keyevent" id="ref-for-dom-navigator-keyevent-1">keyEvent</a></code> with those saved in <code class="idl"><a data-link-type="idl" href="#dom-navigator-reservedkeycodes" id="ref-for-dom-navigator-reservedkeycodes-4">reservedKeyCodes</a></code>.</p>
    <li data-md="">
     <p>If a match is found, dispatch <code class="idl"><a data-link-type="idl" href="#dom-navigator-keyevent" id="ref-for-dom-navigator-keyevent-2">keyEvent</a></code> to the web page.</p>
    <li data-md="">
     <p>If no match is found, allow the OS to process the key as normal.</p>
   </ol>
   <p>It is not required that a conforming implementation be able to override the
    OS default behaviour for every key combination. Specifically, most OSes have
    a “secure attention sequence” that applications cannot override;
    this specification does not supersede that.</p>
   <h2 class="heading settled" data-level="5" id="mobile"><span class="secno">5. </span><span class="content">Mobile Device Considerations</span><a class="self-link" href="#mobile"></a></h2>
   <p>TODO: What level of support do we need on mobile? Is it enough to say that
    it’s a keyboard-focused API and mobile devices typically don’t have
    keyboards? What does Chrome do if you activate full-screen on a mobile
    web site and hit Escape from an attached keyboard? It seems like that should
    also be supported.</p>
   <h2 class="heading settled" data-level="6" id="security"><span class="secno">6. </span><span class="content">Security Considerations</span><a class="self-link" href="#security"></a></h2>
   <p>TODO: How does this proposal prevent malicious sites from taking all
	key events and preventing the user from escaping?</p>
   <p>TODO: How could this be used (alone or in conjunction with
	other APIs) to give the user a bad experience?</p>
   <h2 class="heading settled" data-level="7" id="privacy"><span class="secno">7. </span><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy"></a></h2>
   <p>Not applicable. This API does not use or reveal any personal information
	about the current user.</p>
   <h2 class="heading settled" data-level="8" id="acknowledgements-contributors"><span class="secno">8. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements-contributors"></a></h2>
   <p>Thanks to the following people for the discussions that lead
	to the creation of this proposal:</p>
   <p>Jon Dahlke (Google)</p>
  </main>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dom-navigator-cancelsystemkeyboardlock">cancelSystemKeyboardLock()</a><span>, in §2</span>
   <li><a href="#dom-navigator-keyevent">keyEvent</a><span>, in §4</span>
   <li><a href="#dom-navigator-requestsystemkeyboardlock">requestSystemKeyboardLock()</a><span>, in §2</span>
   <li><a href="#dom-navigator-requestsystemkeyboardlock">requestSystemKeyboardLock(keyCodes)</a><span>, in §2</span>
   <li><a href="#dom-navigator-reservedkeycodes">reservedKeyCodes</a><span>, in §2</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a>
    </ul>
   <li>
    <a data-link-type="biblio">[uievents]</a> defines the following terms:
    <ul>
     <li><a href="https://www.w3.org/TR/uievents/#dom-keyboardevent-code">code</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-html">[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-uievents">[UIEVENTS]
   <dd>Gary Kacmarcik; Travis Leithead. <a href="https://www.w3.org/TR/uievents/">UI Events</a>. 4 August 2016. WD. URL: <a href="https://www.w3.org/TR/uievents/">https://www.w3.org/TR/uievents/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-grabkeyboard">[GrabKeyboard]
   <dd><a href="https://www.x.org/releases/X11R7.7/doc/xproto/x11protocol.html#requests:GrabKeyboard">X11 GrabKeyboard API</a>. URL: <a href="https://www.x.org/releases/X11R7.7/doc/xproto/x11protocol.html#requests:GrabKeyboard">https://www.x.org/releases/X11R7.7/doc/xproto/x11protocol.html#requests:GrabKeyboard</a>
   <dt id="biblio-lowlevelkeyboardproc">[LowLevelKeyboardProc]
   <dd><a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms644985(v=vs.85).aspx">LowLevelKeyboardProc documentation on MSDN</a>. URL: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms644985(v=vs.85).aspx">https://msdn.microsoft.com/en-us/library/windows/desktop/ms644985(v=vs.85).aspx</a>
   <dt id="biblio-quartzeventservices">[QuartzEventServices]
   <dd><a href="https://developer.apple.com/reference/coregraphics/1658572-quartz_event_services">Quartz Event Services</a>. URL: <a href="https://developer.apple.com/reference/coregraphics/1658572-quartz_event_services">https://developer.apple.com/reference/coregraphics/1658572-quartz_event_services</a>
   <dt id="biblio-uievents-code">[UIEvents-Code]
   <dd>Gary Kacmarcik; Travis Leithead. <a href="https://www.w3.org/TR/uievents-code/">UI Events KeyboardEvent code Values</a>. 24 October 2016. WD. URL: <a href="https://www.w3.org/TR/uievents-code/">https://www.w3.org/TR/uievents-code/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl def"><span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a> {
  [Secure Context] <span class="kt">void</span> <a class="nv" href="#dom-navigator-requestsystemkeyboardlock">requestSystemKeyboardLock</a>(<span class="kt">optional</span> <span class="kt">sequence</span>&lt;<span class="kt">DOMString</span>> <a class="nv" href="#dom-navigator-requestsystemkeyboardlock-keycodes-keycodes">keyCodes</a>);
  [Secure Context] <span class="kt">void</span> <a class="nv" href="#dom-navigator-cancelsystemkeyboardlock">cancelSystemKeyboardLock</a>();
};

</pre>
  <aside class="dfn-panel" data-for="dom-navigator-requestsystemkeyboardlock">
   <b><a href="#dom-navigator-requestsystemkeyboardlock">#dom-navigator-requestsystemkeyboardlock</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-navigator-requestsystemkeyboardlock-1">2. Activating and Deactivating System Keyboard Lock</a> <a href="#ref-for-dom-navigator-requestsystemkeyboardlock-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigator-requestsystemkeyboardlock-keycodes-keycodes">
   <b><a href="#dom-navigator-requestsystemkeyboardlock-keycodes-keycodes">#dom-navigator-requestsystemkeyboardlock-keycodes-keycodes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-navigator-requestsystemkeyboardlock-keycodes-keycodes-1">2. Activating and Deactivating System Keyboard Lock</a> <a href="#ref-for-dom-navigator-requestsystemkeyboardlock-keycodes-keycodes-2">(2)</a> <a href="#ref-for-dom-navigator-requestsystemkeyboardlock-keycodes-keycodes-3">(3)</a>
    <li><a href="#ref-for-dom-navigator-requestsystemkeyboardlock-keycodes-keycodes-4">3. Handling Focus Events</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigator-cancelsystemkeyboardlock">
   <b><a href="#dom-navigator-cancelsystemkeyboardlock">#dom-navigator-cancelsystemkeyboardlock</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-navigator-cancelsystemkeyboardlock-1">2. Activating and Deactivating System Keyboard Lock</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigator-reservedkeycodes">
   <b><a href="#dom-navigator-reservedkeycodes">#dom-navigator-reservedkeycodes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-navigator-reservedkeycodes-1">2. Activating and Deactivating System Keyboard Lock</a>
    <li><a href="#ref-for-dom-navigator-reservedkeycodes-2">3. Handling Focus Events</a> <a href="#ref-for-dom-navigator-reservedkeycodes-3">(2)</a>
    <li><a href="#ref-for-dom-navigator-reservedkeycodes-4">4. Handling Key Presses</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-navigator-keyevent">
   <b><a href="#dom-navigator-keyevent">#dom-navigator-keyevent</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-navigator-keyevent-1">4. Handling Key Presses</a> <a href="#ref-for-dom-navigator-keyevent-2">(2)</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while(el.parentElement) {
                if(el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if(el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if(dfnPanel) {
                    console.log(dfnPanel);
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
        </script>